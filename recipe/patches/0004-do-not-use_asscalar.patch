From 4b7451b879e1fb20be54066f6d41845f250374f4 Mon Sep 17 00:00:00 2001
From: Mark Harfouche <mark.harfouche@gmail.com>
Date: Mon, 26 Sep 2022 12:27:58 -0400
Subject: [PATCH] Avoid asscalar

Adapted from: https://github.com/DeepLabCut/DeepLabCut/pull/1982/files
---
 .../datasets/pose_deterministic.py                        | 4 ++--
 .../pose_estimation_tensorflow/datasets/pose_imgaug.py    | 8 ++++----
 .../datasets/pose_tensorpack.py                           | 4 ++--
 3 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/deeplabcut/pose_estimation_tensorflow/datasets/pose_deterministic.py b/deeplabcut/pose_estimation_tensorflow/datasets/pose_deterministic.py
index 0cb4857..df0f306 100644
--- a/deeplabcut/pose_estimation_tensorflow/datasets/pose_deterministic.py
+++ b/deeplabcut/pose_estimation_tensorflow/datasets/pose_deterministic.py
@@ -242,8 +242,8 @@ class DeterministicPoseDataset(BasePoseDataset):
         for person_id in range(len(coords)):
             for k, j_id in enumerate(joint_id[person_id]):
                 joint_pt = coords[person_id][k, :]
-                j_x = np.asscalar(joint_pt[0])
-                j_y = np.asscalar(joint_pt[1])
+                j_x = np.asarray(joint_pt[0]).item()
+                j_y = np.asarray(joint_pt[1]).item()
 
                 # don't loop over entire heatmap, but just relevant locations
                 j_x_sm = round((j_x - self.half_stride) / self.stride)
diff --git a/deeplabcut/pose_estimation_tensorflow/datasets/pose_imgaug.py b/deeplabcut/pose_estimation_tensorflow/datasets/pose_imgaug.py
index fe6cd37..4772f8f 100644
--- a/deeplabcut/pose_estimation_tensorflow/datasets/pose_imgaug.py
+++ b/deeplabcut/pose_estimation_tensorflow/datasets/pose_imgaug.py
@@ -448,9 +448,9 @@ class ImgaugPoseDataset(BasePoseDataset):
         for person_id in range(len(coords)):
             for k, j_id in enumerate(joint_id[person_id]):
                 joint_pt = coords[person_id][k, :]
-                j_x = np.asscalar(joint_pt[0])
+                j_x = np.asarray(joint_pt[0]).item()
                 j_x_sm = round((j_x - self.half_stride) / self.stride)
-                j_y = np.asscalar(joint_pt[1])
+                j_y = np.asarray(joint_pt[1]).item()
                 j_y_sm = round((j_y - self.half_stride) / self.stride)
                 map_j = grid.copy()
                 # Distance between the joint point and each coordinate
@@ -495,9 +495,9 @@ class ImgaugPoseDataset(BasePoseDataset):
         for person_id in range(len(coords)):
             for k, j_id in enumerate(joint_id[person_id]):
                 joint_pt = coords[person_id][k, :]
-                j_x = np.asscalar(joint_pt[0])
+                j_x = np.asarray(joint_pt[0]).item()
                 j_x_sm = round((j_x - self.half_stride) / self.stride)
-                j_y = np.asscalar(joint_pt[1])
+                j_y = np.asarray(joint_pt[1]).item()
                 j_y_sm = round((j_y - self.half_stride) / self.stride)
                 min_x = round(max(j_x_sm - dist_thresh - 1, 0))
                 max_x = round(min(j_x_sm + dist_thresh + 1, width - 1))
diff --git a/deeplabcut/pose_estimation_tensorflow/datasets/pose_tensorpack.py b/deeplabcut/pose_estimation_tensorflow/datasets/pose_tensorpack.py
index 77ba502..397489b 100644
--- a/deeplabcut/pose_estimation_tensorflow/datasets/pose_tensorpack.py
+++ b/deeplabcut/pose_estimation_tensorflow/datasets/pose_tensorpack.py
@@ -358,8 +358,8 @@ class TensorpackPoseDataset(BasePoseDataset):
         for person_id in range(len(coords)):
             for k, j_id in enumerate(joint_id[person_id]):
                 joint_pt = coords[person_id][k, :]
-                j_x = np.asscalar(joint_pt[0])
-                j_y = np.asscalar(joint_pt[1])
+                j_x = np.asarray(joint_pt[0]).item()
+                j_y = np.asarray(joint_pt[1]).item()
 
                 # don't loop over entire heatmap, but just relevant locations
                 j_x_sm = round((j_x - half_stride) / stride)
-- 
2.34.1

